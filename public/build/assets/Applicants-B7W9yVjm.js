import{d as J,c as G,g as k,k as O,l as L,i as Q,p as u,o as n,f as t,u as e,s as X,w as l,q as d,b as h,y as r,F as x,x as g,a as y,z as i,v as Y,A as Z,J as ee,K as te}from"./app-D6R7nxIP.js";import{_ as se}from"./AppLayout.vue_vue_type_script_setup_true_lang-CCymuoZl.js";import{_ as le}from"./index-IEVQ08sT.js";import{_ as $}from"./createLucideIcon-BZBA9KVG.js";import{_ as F,a as M,b as N,c as P,d as U,e as q}from"./DialogTitle.vue_vue_type_script_setup_true_lang-_j2ihN7g.js";import{a as z,_ as H}from"./Label.vue_vue_type_script_setup_true_lang-SnXVOEaH.js";import{S as ae,_ as re,a as ne,b as ue,c as ie,d as oe,F as de,e as me,f as fe,g as _e,E as K}from"./SelectValue.vue_vue_type_script_setup_true_lang-CMTv_bzG.js";import{_ as pe,a as ce,b as j,c as v,d as ve,e as p}from"./TableHeader.vue_vue_type_script_setup_true_lang-C512FyO5.js";import{C as xe}from"./clipboard-list-DN5fr73t.js";import"./useForwardExpose-CmhIoYSZ.js";import"./Presence-DEvxkzvY.js";import"./SheetContent.vue_vue_type_script_setup_true_lang-BcCljalg.js";import"./VisuallyHidden-CNMTvYBA.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DUXMEEEj.js";import"./check-DYYfs4CG.js";import"./useFormControl-CyvCgWHy.js";const ge={class:"flex h-full flex-1 flex-col gap-4 p-4"},be={class:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between"},ke={class:"relative w-full md:max-w-md"},ye={class:"grid gap-1"},$e={class:"rounded-xl border border-sidebar-border/70 dark:border-sidebar-border"},we={class:"flex justify-end gap-2"},Se={key:0,class:"flex items-center justify-center py-2"},Te=["innerHTML"],Ve={class:"space-y-2"},Ce={key:0,class:"text-sm text-muted-foreground"},he={key:1,class:"space-y-2"},je=["href"],Be={key:1,class:"text-sm text-muted-foreground"},Le={class:"space-y-3"},Fe={class:"min-w-0"},Me={class:"truncate font-medium"},Ne=["href"],Pe={class:"flex items-center gap-2"},Ue={key:0,class:"text-sm text-red-600"},Ze=J({__name:"Applicants",props:{items:{},filters:{},meta:{}},setup(A){const f=A,D=[{title:"Pendaftar",href:route("guardian.applicants.index")}],B=G(()=>(f.items.data||[]).filter(o=>!!o)),w=k(f.filters.q??""),S=k(String(f.filters.perPage??10));let V;O([w,S],()=>{V&&clearTimeout(V),V=window.setTimeout(()=>{L.get(route("guardian.applicants.index"),{q:w.value,perPage:S.value},{preserveScroll:!0,preserveState:!0,replace:!0,only:["items","filters","meta"]})},300)});const T=k(!1),b=k(!1),c=k(null);function E(o){c.value=o,T.value=!0}const _=Q({scores:[]});function R(o){c.value=o;const s=o.scores||{};_.scores=f.meta.subjects.map(a=>({subject_id:a.id,score:Number.isFinite(s[a.id])?Number(s[a.id]):null})),b.value=!0}function W(){c.value&&(_.scores.map(o=>({subject_id:o.subject_id,score:typeof o.score=="number"?Math.max(0,Math.min(100,o.score)):0})),_.post(route("guardian.applicants.scores.store",c.value.id),{preserveScroll:!0,onSuccess:()=>{b.value=!1,L.reload({only:["items"],preserveScroll:!0})}}))}function I(o){return o==="Lulus Tes"?"default":o==="Tidak Lulus Tes"?"destructive":"secondary"}return(o,s)=>(n(),u(x,null,[t(e(X),{title:"Pendaftar"}),t(se,{breadcrumbs:D},{default:l(()=>[d("div",ge,[d("div",be,[d("div",ke,[t(e(ae),{class:"absolute top-1/2 left-2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t(e(z),{modelValue:w.value,"onUpdate:modelValue":s[0]||(s[0]=a=>w.value=a),class:"pl-8",placeholder:"Cari siswa/wali/telepon…"},null,8,["modelValue"])]),d("div",ye,[t(e(H),{class:"text-xs"},{default:l(()=>s[6]||(s[6]=[r("Baris",-1)])),_:1,__:[6]}),t(e(re),{modelValue:S.value,"onUpdate:modelValue":s[1]||(s[1]=a=>S.value=a)},{default:l(()=>[t(e(ne),{class:"w-[110px]"},{default:l(()=>[t(e(ue),{placeholder:String(f.filters.perPage??10)},null,8,["placeholder"])]),_:1}),t(e(ie),null,{default:l(()=>[(n(!0),u(x,null,g(f.meta.perPages,a=>(n(),y(e(oe),{key:a,value:String(a)},{default:l(()=>[r(i(a),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])])]),d("div",$e,[t(e(pe),null,{default:l(()=>[t(e(ce),null,{default:l(()=>[t(e(j),null,{default:l(()=>[t(e(v),{class:"w-[48px] text-center"},{default:l(()=>s[7]||(s[7]=[r("#",-1)])),_:1,__:[7]}),t(e(v),null,{default:l(()=>s[8]||(s[8]=[r("Siswa",-1)])),_:1,__:[8]}),t(e(v),null,{default:l(()=>s[9]||(s[9]=[r("Wali",-1)])),_:1,__:[9]}),t(e(v),null,{default:l(()=>s[10]||(s[10]=[r("Telepon",-1)])),_:1,__:[10]}),t(e(v),null,{default:l(()=>s[11]||(s[11]=[r("Rata-rata",-1)])),_:1,__:[11]}),t(e(v),null,{default:l(()=>s[12]||(s[12]=[r("Status",-1)])),_:1,__:[12]}),t(e(v),null,{default:l(()=>s[13]||(s[13]=[r("Daftar",-1)])),_:1,__:[13]}),t(e(v),{class:"w-[240px] text-right"},{default:l(()=>s[14]||(s[14]=[r("Aksi",-1)])),_:1,__:[14]})]),_:1})]),_:1}),t(e(ve),null,{default:l(()=>[(n(!0),u(x,null,g(B.value,(a,m)=>(n(),y(e(j),{key:a.id},{default:l(()=>[t(e(p),{class:"text-center"},{default:l(()=>[r(i(m+1),1)]),_:2},1024),t(e(p),{class:"font-medium"},{default:l(()=>[r(i(a.student_name),1)]),_:2},1024),t(e(p),null,{default:l(()=>[r(i(a.guardian_name),1)]),_:2},1024),t(e(p),null,{default:l(()=>[r(i(a.guardian_phone),1)]),_:2},1024),t(e(p),null,{default:l(()=>[r(i(a.average_score??"-"),1)]),_:2},1024),t(e(p),null,{default:l(()=>[t(e(le),{variant:I(a.status)},{default:l(()=>[r(i(a.status),1)]),_:2},1032,["variant"])]),_:2},1024),t(e(p),null,{default:l(()=>[r(i(a.created_at??"-"),1)]),_:2},1024),t(e(p),{class:"text-right"},{default:l(()=>[d("div",we,[t(e($),{size:"sm",variant:"outline",onClick:C=>E(a)},{default:l(()=>[t(e(de),{class:"mr-2 h-4 w-4"}),s[15]||(s[15]=r(" Lihat Berkas ",-1))]),_:2,__:[15]},1032,["onClick"]),t(e($),{class:"bg-emerald-600 text-white hover:bg-emerald-700",size:"sm",onClick:C=>R(a)},{default:l(()=>[t(e(xe),{class:"mr-2 h-4 w-4"}),s[16]||(s[16]=r(" Kerjakan Tes ",-1))]),_:2,__:[16]},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128)),B.value.length===0?(n(),y(e(j),{key:0},{default:l(()=>[t(e(p),{class:"text-center text-muted-foreground",colspan:"8"},{default:l(()=>s[17]||(s[17]=[r(" Belum ada data siswa ",-1)])),_:1,__:[17]})]),_:1})):h("",!0)]),_:1})]),_:1})]),f.items.links.length?(n(),u("div",Se,[t(e(me),null,{default:l(()=>[t(e(fe),null,{default:l(()=>[(n(!0),u(x,null,g(f.items.links,(a,m)=>(n(),y(e(_e),{key:m,class:"select-none"},{default:l(()=>[a?.url?(n(),y(e(Y),{key:0,class:Z([[a.active?"bg-emerald-600 text-white hover:bg-emerald-700":"hover:bg-muted"],"rounded-md px-3 py-1 text-sm transition-colors"]),href:a.url,"preserve-scroll":!0,"preserve-state":!0,innerHTML:a.label},null,8,["class","href","innerHTML"])):(n(),u("span",{key:1,class:"rounded-md px-3 py-1 text-sm text-muted-foreground opacity-50",innerHTML:a.label},null,8,Te))]),_:2},1024))),128))]),_:1})]),_:1})])):h("",!0)]),t(e(F),{open:T.value,"onUpdate:open":s[3]||(s[3]=a=>T.value=a)},{default:l(()=>[t(e(M),{class:"sm:max-w-lg"},{default:l(()=>[t(e(N),null,{default:l(()=>[t(e(P),null,{default:l(()=>s[18]||(s[18]=[r("Berkas Pendaftar",-1)])),_:1,__:[18]}),t(e(U),null,{default:l(()=>[r(i(c.value?.student_name||"-"),1)]),_:1})]),_:1}),d("div",Ve,[(c.value?.files?.length||0)===0?(n(),u("div",Ce,"Belum ada berkas.")):(n(),u("ul",he,[(n(!0),u(x,null,g(c.value?.files,(a,m)=>(n(),u("li",{key:m,class:"flex items-center justify-between rounded-md border p-2"},[d("span",null,i(a.label),1),a.path?(n(),u("a",{key:0,href:a.path,class:"inline-flex items-center text-emerald-700 hover:underline",rel:"noopener",target:"_blank"},[s[19]||(s[19]=r(" Buka ",-1)),t(e(K),{class:"ml-1 h-4 w-4"})],8,je)):(n(),u("span",Be,"-"))]))),128))]))]),t(e(q),null,{default:l(()=>[t(e($),{variant:"secondary",onClick:s[2]||(s[2]=a=>T.value=!1)},{default:l(()=>s[20]||(s[20]=[r("Tutup",-1)])),_:1,__:[20]})]),_:1})]),_:1})]),_:1},8,["open"]),t(e(F),{open:b.value,"onUpdate:open":s[5]||(s[5]=a=>b.value=a)},{default:l(()=>[t(e(M),{class:"sm:max-w-lg"},{default:l(()=>[t(e(N),null,{default:l(()=>[t(e(P),null,{default:l(()=>s[21]||(s[21]=[r("Isi Nilai Tes",-1)])),_:1,__:[21]}),t(e(U),null,{default:l(()=>[r(i(c.value?.student_name||"-")+" — KKM: "+i(f.meta.passMark),1)]),_:1})]),_:1}),d("div",Le,[(n(!0),u(x,null,g(f.meta.subjects,(a,m)=>(n(),u("div",{key:a.id,class:"grid grid-cols-1 items-center gap-2 sm:grid-cols-[1fr,120px,auto]"},[d("div",Fe,[d("div",Me,i(a.name),1),d("a",{href:a.link_url,class:"text-xs text-emerald-700 hover:underline",rel:"noopener",target:"_blank"},[s[22]||(s[22]=r(" Buka Tes ",-1)),t(e(K),{class:"inline h-3 w-3"})],8,Ne)]),d("div",Pe,[t(e(H),{for:`score-${a.id}`,class:"sr-only"},{default:l(()=>[r("Nilai "+i(a.name),1)]),_:2},1032,["for"]),t(e(z),{id:`score-${a.id}`,modelValue:e(_).scores[m].score,"onUpdate:modelValue":C=>e(_).scores[m].score=C,modelModifiers:{number:!0},max:"100",min:"0",placeholder:"0",type:"number"},null,8,["id","modelValue","onUpdate:modelValue"])]),s[23]||(s[23]=d("div",{class:"text-xs text-muted-foreground"},"0–100",-1))]))),128)),e(_).errors.scores?(n(),u("p",Ue,i(e(_).errors.scores),1)):h("",!0),(n(!0),u(x,null,g(e(_).errors,(a,m)=>ee((n(),u("p",{key:m,class:"text-sm text-red-600"},i(a),1)),[[te,m.startsWith("scores.")]])),128))]),t(e(q),null,{default:l(()=>[t(e($),{variant:"secondary",onClick:s[4]||(s[4]=a=>b.value=!1)},{default:l(()=>s[24]||(s[24]=[r("Batal",-1)])),_:1,__:[24]}),t(e($),{disabled:e(_).processing,onClick:W},{default:l(()=>s[25]||(s[25]=[r("Simpan Nilai",-1)])),_:1,__:[25]},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{Ze as default};
